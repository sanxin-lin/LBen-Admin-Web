var U=Object.defineProperty,F=Object.defineProperties;var G=Object.getOwnPropertyDescriptors;var O=Object.getOwnPropertySymbols;var V=Object.prototype.hasOwnProperty,Y=Object.prototype.propertyIsEnumerable;var j=(e,n,t)=>n in e?U(e,n,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[n]=t,S=(e,n)=>{for(var t in n||(n={}))V.call(n,t)&&j(e,t,n[t]);if(O)for(var t of O(n))Y.call(n,t)&&j(e,t,n[t]);return e},x=(e,n)=>F(e,G(n));var H=(e,n,t)=>new Promise((u,s)=>{var a=r=>{try{d(t.next(r))}catch(i){s(i)}},f=r=>{try{d(t.throw(r))}catch(i){s(i)}},d=r=>r.done?u(r.value):Promise.resolve(r.value).then(a,f);d((t=t.apply(e,n)).next())});import{ay as Z,U as $,cB as z,cP as J,dj as K,dZ as T,dt as w,d4 as Q,d5 as X,c_ as y,r as l,i as C,l as ee,u as m,j as v,a2 as D,c as ne,bG as te}from"./entry/index-Dbo3_afc-1721993229481.js";import{u as re}from"./uniqueId-qqMk_9BJ.js";import{S as se}from"./IconPicker-CgkkXBkI.js";import{a as oe}from"./useWindowSize-eZwsA2jU.js";import{S as ue}from"./Loading-BsT2ninQ.js";var ae=function(e,n,t){t===void 0&&(t={});var u=Z(e);re(function(){var s=$(n);if(s){var a=new MutationObserver(u.current);return a.observe(s,t),function(){a==null||a.disconnect()}}},[t],n)};function ce(){}function ie(e,n,t,u){for(var s=e.length,a=t+(u?1:-1);u?a--:++a<s;)if(n(e[a],a,e))return a;return-1}function le(e){return e!==e}function fe(e,n,t){for(var u=t-1,s=e.length;++u<s;)if(e[u]===n)return u;return-1}function de(e,n,t){return n===n?fe(e,n,t):ie(e,le,t)}function he(e,n){var t=e==null?0:e.length;return!!t&&de(e,n,0)>-1}function ge(e,n,t){for(var u=-1,s=e==null?0:e.length;++u<s;)if(t(n,e[u]))return!0;return!1}var pe="[object Boolean]";function Le(e){return e===!0||e===!1||z(e)&&J(e)==pe}function Me(e,n){return K(e,n)}var be=1/0,Re=T&&1/w(new T([,-0]))[1]==be?function(e){return new T(e)}:ce,Se=200;function ve(e,n,t){var u=-1,s=he,a=e.length,f=!0,d=[],r=d;if(t)f=!1,s=ge;else if(a>=Se){var i=n?null:Re(e);if(i)return w(i);f=!1,s=X,r=new Q}else r=n?[]:d;e:for(;++u<a;){var o=e[u],c=n?n(o):o;if(o=t||o!==0?o:0,f&&c===c){for(var h=r.length;h--;)if(r[h]===c)continue e;n&&r.push(c),d.push(o)}else s(r,c,t)||(r!==d&&r.push(c),d.push(o))}return d}function ke(e,n){return e&&e.length?ve(e,y(n)):[]}const xe=()=>{const[,e]=l.useReducer(n=>n+1,0);return e};function He(e){const n=l.useRef(e);n.current=e;const t=l.useRef([]);return l.useEffect(()=>{t.current.forEach(s=>s())},[e]),l.useMemo(()=>({subscribe:s=>(t.current.push(s),()=>{t.current=t.current.filter(a=>a!==s)}),getState:()=>n.current}),[])}function Te(e,n){var d,r,i,o;const t=n!=null?n:c=>c,u=xe(),s=l.useContext(e),a=l.useRef(t((r=(d=s.getState)==null?void 0:d.call(s))!=null?r:{}));a.current=t((o=(i=s.getState)==null?void 0:i.call(s))!=null?o:{});const f=l.useCallback(()=>{var c,h;t((h=(c=s.getState)==null?void 0:c.call(s))!=null?h:{})!==a.current&&u()},[s]);return l.useEffect(()=>{if(C(s.subscribe)){const c=s.subscribe(f);return()=>{c()}}},[s,f]),a.current}const me="Sunshine Admin";function L(e){throw new Error(`[${me} error]:${e}`)}const k=l.createContext({});function Ie(e){return He(e)}function qe(e){return Te(k,e)}const Ae=l.forwardRef((e,n)=>{const{children:t,loading:u=!1,useWrapper:s=!0,modalFooterHeight:a=74,modalHeaderHeight:f=57,height:d,footerOffset:r=0,open:i,fullScreen:o,loadingTip:c,onHeightChange:h,onExtHeight:g}=e,R=l.useRef(null),b=l.useRef(null),[I,A]=l.useState(0),[E,N]=l.useState(0),[W,Ee]=l.useState(0),p=()=>H(void 0,null,function*(){});ae(()=>{p()},b,{attributes:!0,subtree:!0}),l.useEffect(()=>{s&&p()},[s]),l.useEffect(()=>{p(),o?N(I):A(E)},[o,I,E]),oe(()=>{p()}),ee(()=>{g==null||g(f+a)}),m(()=>{});const _=()=>H(void 0,null,function*(){D(()=>{var P;const M=R.current;M&&((P=M==null?void 0:M.scrollTo)==null||P.call(M,0))})});l.useImperativeHandle(n,()=>({scrollTop:_,setModalHeight:p}));const B=Ie({redoModalHeight:p});return v.jsx(k.Provider,{value:B,children:v.jsx(se,{ref:R,scrollHeight:W,children:v.jsx("div",{ref:b,"loading-tip":c,children:v.jsx(ue,{spinning:u,children:t})})})})}),q=ne((e,n)=>({dataTransfer:{},openData:{},updateDataTransfer(t,u){e({dataTransfer:x(S({},n().dataTransfer),{[t]:u})})},updateOpenData(t,u){e({openData:x(S({},n().openData),{[t]:u})})}})),Ne=()=>{const e=l.useRef(null),n=l.useRef(!1),t=l.useRef("0"),{dataTransfer:u,openData:s,updateDataTransfer:a,updateOpenData:f}=q();m(()=>{e.current=null,n.current=!1,a(t.current,null)});const d=(o,c)=>{n.current&&te()&&o===e.current||(t.current=c,e.current=o,n.current=!0,o.emitOpen=(h,g)=>{f(g,h)})},r=()=>{const o=e.current;return o||L("useModal instance is undefined!"),o};return[d,{setModalProps:o=>{var c;(c=r())==null||c.setModalProps(o)},getOpen:()=>s[t.current],redoModalHeight:()=>{var o,c;(c=(o=r())==null?void 0:o.redoModalHeight)==null||c.call(o)},openModal:(o=!0,c,h=!0)=>{var b;if((b=r())==null||b.setModalProps({open:o}),!c)return;const g=t.current,R=Me(u[g],c);if(h||!R){a(g,S({},c));return}},closeModal:()=>{var o;(o=r())==null||o.setModalProps({open:!1})}}]},We=(e,n)=>{const t=l.useRef(null),u=l.useRef("0"),{dataTransfer:s,openData:a}=q(),f=()=>{const r=t.current;return r||L("useModalInner instance is undefined!"),r};m(()=>{t.current=null});const d=(r,i)=>{u.current=i,t.current=r,e(r,i)};return l.useEffect(()=>{const r=s[u.current];r&&(!n||!C(n)||D(()=>{n(r)}))},[s]),[d,{changeLoading:(r=!0)=>{var i;(i=f())==null||i.setModalProps({loading:r})},getOpen:()=>a[u.current],changeOkLoading:(r=!0)=>{var i;(i=f())==null||i.setModalProps({confirmLoading:r})},closeModal:()=>{var r;(r=f())==null||r.setModalProps({open:!1})},setModalProps:r=>{var i;(i=f())==null||i.setModalProps(r)},redoModalHeight:()=>{var i;const r=(i=f())==null?void 0:i.redoModalHeight;r&&r()}}]};export{Ae as M,Te as a,We as b,He as c,Ne as d,Me as e,L as f,xe as g,qe as h,Le as i,he as j,ge as k,ie as l,de as m,ce as n,le as o,ve as p,ke as u};
