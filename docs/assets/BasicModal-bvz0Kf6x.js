var re=Object.defineProperty,le=Object.defineProperties;var ae=Object.getOwnPropertyDescriptors;var P=Object.getOwnPropertySymbols;var Y=Object.prototype.hasOwnProperty,X=Object.prototype.propertyIsEnumerable;var A=(e,o,t)=>o in e?re(e,o,{enumerable:!0,configurable:!0,writable:!0,value:t}):e[o]=t,p=(e,o)=>{for(var t in o||(o={}))Y.call(o,t)&&A(e,t,o[t]);if(P)for(var t of P(o))X.call(o,t)&&A(e,t,o[t]);return e},x=(e,o)=>le(e,ae(o));var W=(e,o)=>{var t={};for(var s in e)Y.call(e,s)&&o.indexOf(s)<0&&(t[s]=e[s]);if(e!=null&&P)for(var s of P(e))o.indexOf(s)<0&&X.call(e,s)&&(t[s]=e[s]);return t};var z=(e,o,t)=>new Promise((s,d)=>{var c=r=>{try{a(t.next(r))}catch(l){d(l)}},T=r=>{try{a(t.throw(r))}catch(l){d(l)}},a=r=>r.done?s(r.value):Promise.resolve(r.value).then(c,T);a((t=t.apply(e,o)).next())});import{r as S,j as u,dY as ce,t as ie,E as ue,B as V,a as H,bi as G,l as de,a2 as J,i as me,bl as fe}from"./entry/index-Dbo3_afc-1721993229481.js";import{u as pe}from"./useEarliest-TICvMVV0.js";import{u as K}from"./useDesign-mHzxmH92.js";import{u as Q}from"./useLocale-DOr0Jbh6.js";import{M as ge}from"./useModal-D6jWE9f_.js";import{T as E}from"./index-CqkgspeZ.js";import{R as he,a as xe}from"./FullscreenOutlined-Bzam2OPN.js";import"./IconPicker-CgkkXBkI.js";import{B as Ce}from"./BasicTitle-cKsQiyFr.js";import{a as Fe}from"./uniqueId-qqMk_9BJ.js";import{h as Te}from"./useMenuSetting-Bic0zQ6z.js";function ye(e){const{destroyOnClose:o,draggable:t,open:s}=e,d=(a,r)=>getComputedStyle(a)[r],c=a=>{if(!a)return;a.setAttribute("data-drag",t);const r=a.querySelector(".ant-modal-header"),l=a.querySelector(".ant-modal");!r||!l||!t||(r.style.cursor="move",r.onmousedown=g=>{if(!g)return;const C=g.clientX,i=g.clientY,m=document.body.clientWidth,w=document.documentElement.clientHeight,O=l.offsetWidth,b=l.offsetHeight,j=l.offsetLeft,M=m-l.offsetLeft-O,D=l.offsetTop,v=w-l.offsetTop-b,h=d(l,"left"),B=d(l,"top");let y=+h,F=+B;h.includes("%")?(y=+document.body.clientWidth*(+h.replace(/%/g,"")/100),F=+document.body.clientHeight*(+B.replace(/%/g,"")/100)):(y=+h.replace(/px/g,""),F=+B.replace(/px/g,"")),document.onmousemove=function(N){let f=N.clientX-C,k=N.clientY-i;-f>j?f=-j:f>M&&(f=M),-k>D?k=-D:k>v&&(k=v),l.style.cssText+=`;left:${f+y}px;top:${k+F}px;`},document.onmouseup=()=>{document.onmousemove=null,document.onmouseup=null}})},T=()=>{const a=document.querySelectorAll(".ant-modal-wrap");for(const r of Array.from(a)){if(!r)continue;const l=d(r,"display"),g=r.getAttribute("data-drag");l!=="none"&&(g===null||o)&&c(r)}};S.useEffect(()=>{!s||!t||setTimeout(()=>{T()},30)},[s,t])}const be=e=>{const s=e,{children:o}=s,t=W(s,["children"]);return ye({open:!!e.open,destroyOnClose:e.destroyOnClose,draggable:!!e.draggable}),u.jsx(ce,x(p({},t),{children:o}))},ke=e=>{const i=e,{canFullscreen:o=!0,fullScreen:t,className:s,onFullScreen:d,onCancel:c}=i,T=W(i,["canFullscreen","fullScreen","className","onFullScreen","onCancel"]),{prefixCls:a}=K("basic-modal-close"),{t:r}=Q(),l=ie(`${a} ${a}--custom ${s}`,{[`${a}--can-full`]:e.canFullscreen}),g=m=>{c==null||c(m)},C=m=>{m==null||m.stopPropagation(),m==null||m.preventDefault(),d==null||d(m)};return u.jsxs("div",x(p({},T),{className:l,children:[o&&u.jsx(u.Fragment,{children:t?u.jsx(E,{title:r("component.modal.restore"),placement:"bottom",children:u.jsx(he,{role:"full",onClick:C})}):u.jsx(E,{title:r("component.modal.maximize"),placement:"bottom","v-else":!0,children:u.jsx(xe,{role:"close",onClick:C})})}),u.jsx(E,{title:r("component.modal.close"),placement:"bottom",children:u.jsx(ue,{onClick:g})})]}))},we=e=>{const{insertFooter:o,centerFooter:t,appendFooter:s,showCancelBtn:d,cancelButtonProps:c={},className:T,cancelText:a,okText:r,okType:l,confirmLoading:g,showOkBtn:C,okButtonProps:i={},onOk:m,onCancel:w}=e;return u.jsxs("div",{className:T,children:[o,d&&u.jsx(V,x(p({},c),{onClick:w,children:a})),t,C&&u.jsx(V,x(p({type:l,onClick:m,loading:g},i),{children:r})),s]})},Se=e=>{const{helpMessage:o,title:t}=e;return u.jsx(Ce,{helpMessage:o,children:t})};function je(e){const[o,t]=S.useState(!1),s=(()=>{const c=e.wrapClassName||"";return o?`fullscreen-modal ${c} `:c})();function d(c){c&&c.stopPropagation(),t(!o)}return{wrapClassName:s,handleFullScreen:d,fullScreen:o,setFullScreen:t}}const Ie=e=>{const{register:o,onOk:t,onCancel:s,onFullscreen:d,onHeightChange:c,canFullscreen:T,closeIcon:a,children:r,wrapperFooterOffset:l,onOpenChange:g,onUpdateOpen:C}=e,[i,m]=S.useState(!1),[w,O]=S.useState(null),b=S.useRef(null),{prefixCls:j}=K("basic-modal"),M=pe(()=>Fe()),{t:D}=Q(),v=()=>({canFullscreen:!0,wrapperFooterOffset:0,useWrapper:!0,showCancelBtn:!0,showOkBtn:!0,closable:!0,mask:!0,maskClosable:!0,keyboard:!0,okType:"primary",cancelText:D("common.cancelText"),okText:D("common.okText")}),h=H(()=>x(p(p(p({},v()),e),w),{open:i}),[e,w,i]),{handleFullScreen:B,wrapClassName:y,fullScreen:F,setFullScreen:N}=je({modalWrapperRef:b,wrapClassName:h.wrapClassName}),f=H(()=>{const n=x(p({},h),{open:i,okButtonProps:void 0,cancelButtonProps:void 0,title:void 0});return x(p({},n),{wrapClassName:y})},[h,i,y]),k=H(()=>{const n=p({open:i},h);return n.wrapClassName===y?n.wrapClassName=`${n.wrapClassName||""} `+j:n.wrapClassName=`${y||""}`+j,F?G(n,["height","title"]):G(n,"title")},[h,y,i,F]),L=n=>z(void 0,null,function*(){var I,q;if(n==null||n.stopPropagation(),!((q=(I=n.target)==null?void 0:I.classList)!=null&&q.contains(j+"-close--custom"))){if(e.closeFunc&&me(e.closeFunc)){const se=yield e.closeFunc();m(!se);return}m(!1),s==null||s(n)}}),$={setModalProps:n=>{O(p({},fe(w||{},n))),Reflect.has(n,"open")&&m(!!n.open),Reflect.has(n,"defaultFullscreen")&&N(!!n.defaultFullscreen)},emitOpen:void 0,redoModalHeight:()=>{J(()=>{b.current&&b.current.setModalHeight()})}};de(()=>{o($,M.current)});const Z=n=>{t==null||t(n)};function _(n){c==null||c(n)}function U(n){T&&(n.stopPropagation(),R(n))}function R(n){B(n),d==null||d(n)}const ee=H(()=>{if(!F)return f.height},[F,f]);S.useEffect(()=>{m(!!e.open),N(!!e.defaultFullscreen)},[e.open,e.defaultFullscreen]),S.useEffect(()=>{g==null||g(i),C==null||C(i),$.emitOpen&&$.emitOpen(i,M.current),J(()=>{e.scrollTop&&i&&b.current&&b.current.scrollTop()})},[i,e.scrollTop]);const te=()=>a||u.jsx(ke,{canFullscreen:f.canFullscreen,fullScreen:F,onCancel:L,onFullScreen:R}),oe=()=>u.jsx(Se,{helpMessage:f.helpMessage,title:h.title,onDbClick:U}),ne=()=>Te(e,"footer")?e.footer:u.jsx(we,x(p({},k),{onOk:Z,onCancel:L}));return u.jsx(be,x(p({},k),{closeIcon:te(),title:oe(),footer:ne(),children:u.jsx(ge,x(p({},f.wrapperProps),{useWrapper:!!f.useWrapper,footerOffset:l,fullScreen:F,ref:b,loading:!!f.loading,"loading-tip":f.loadingTip,minHeight:f.minHeight,height:ee,open:i,onHeightChange:_,children:r}))}))};export{Ie as B};
